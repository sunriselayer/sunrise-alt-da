# Sunrise OP DA Server

This repo implements a Sunrise DA Server for Alt-DA mode using generic
commitments.

The `sunrise-op-da-server` connects to a sunrise-node running as a sidecar process.

sunrise da-server accepts the following flags for sunrise storage

```shell
    --sunrise.server value             (default: "http://localhost:26658") ($OP_PLASMA_DA_SERVER_SUNRISE_SERVER)
          sunrise server endpoint

    --sunrise.data-shard-count value   (default: 10)                    ($OP_PLASMA_DA_SERVER_SUNRISE_DATA_SHARD_COUNT)
          sunrise data shard count

    --sunrise.parity-shard-count value (default: 10)                    ($OP_PLASMA_DA_SERVER_SUNRISE_PARITY_SHARD_COUNT)
          sunrise parity shard count
```

The sunrise server endpoint should be set to the sunrise-data backend,
usually `http://127.0.0.1:8000`.

## How to run testnet with da-server

### Prerequisites

You should use at least the following compatible op* versions when running your chain.

- op-node/v1.9.1
- op-proposer/v1.9.1
- op-batcher/v1.9.1
- [Latest version of op-geth](https://github.com/ethereum-optimism/op-geth/releases/latest)

## Run Sunrise Node

You can refer the [sunrise repo](https://github.com/sunriselayer/sunrise) for the setup and running of the sunrise node along with the [sunrise-data](https://github.com/sunriselayer/sunrise-data).

## Setup DA server

```sh
da-server
      --sunrise.server=http://localhost:8000
      --sunrise.data_shard_count=10
      --sunrise.parity_shard_count=10
```

## Configure Your `op-node`

- Spin up your OP chain as usual but set `--altda.enabled=true` and point both `op-batcher` and `op-node` to the DA server.
- No configuration changes are required for `op-geth` or `op-proposer`.

```sh
   Alt-DA (EXPERIMENTAL)

   
    --altda.da-server value                                               ($OP_NODE_ALTDA_DA_SERVER)
          HTTP address of a DA Server
   
    --altda.enabled                    (default: false)                   ($OP_NODE_ALTDA_ENABLED)
          Enable Alt-DA mode
   
    --altda.verify-on-read             (default: true)                    ($OP_NODE_ALTDA_VERIFY_ON_READ)
          Verify input data matches the commitments from the DA storage service
```

## Configure Your Batcher

- Set `--altda.enabled=true` and `--altda.da-service=true`.
- Provide the URL for `--atlda.da-server=$DA_SERVER_HTTP_URL`.

```sh
    --altda.da-server value                                               ($OP_BATCHER_ALTDA_DA_SERVER)
          HTTP address of a DA Server
   
    --altda.da-service                 (default: false)                   ($OP_BATCHER_ALTDA_DA_SERVICE)
          Use DA service type where commitments are generated by the DA server
   
    --altda.enabled                    (default: false)                   ($OP_BATCHER_ALTDA_ENABLED)
          Enable Alt-DA mode
   
    --altda.verify-on-read             (default: true)                    ($OP_BATCHER_ALTDA_VERIFY_ON_READ)
          Verify input data matches the commitments from the DA storage service
```
